import{ls}from"../common/common.js";import{Issue,IssueCategory,IssueDescription,IssueKind}from"./Issue.js";export class SameSiteCookieIssue extends Issue{constructor(e,t){super(e),this._issueDetails=t}static codeForSameSiteDetails(e,t){return[Protocol.Audits.InspectorIssueCode.SameSiteCookieIssue,e,t].join("::")}cookies(){return[this._issueDetails.cookie]}requests(){return this._issueDetails.request?[this._issueDetails.request]:[]}getCategory(){return IssueCategory.SameSiteCookie}getDescription(){const e=issueDescriptions.get(this.code());return e||null}}function textMessageWithResolutions(e,t){const i=createElementWithClass("div","message");if(i.createChild("p").textContent=e,t.length>0){const e=i.createChild("p");e.createChild("span","resolutions-label").textContent=ls`Resolve by`;const s=createElementWithClass("ul","resolutions-list");e.appendChild(s);for(const e of t)s.createChild("li").textContent=e}return i}const issueDescriptions=new Map([["SameSiteCookieIssue::ExcludeSameSiteUnspecifiedTreatedAsLax::ReadCookie",{title:ls`A cookie was not sent because the cookie's 'SameSite' attribute was defaulted to 'SameSite=Lax'`,message:()=>textMessageWithResolutions(ls`A cookie was defaulted to 'SameSite=Lax' because the cookie's 'SameSite' attribute was not set or invalid. The cookie was not sent because the default behavior for 'SameSite=Lax' prevents this cookie from beeing sent in cross-site requests.`,[ls`If the cookie is intended for third parties, mark the cookie as 'SameSite=None; Secure'.`,ls`If the cookie is not intended for third parties, consider explicitly marking the cookie as 'SameSite=Strict' or 'SameSite=Lax' to make your intent clear and provide a consistent experience across browsers.`]),issueKind:IssueKind.BreakingChange,link:ls`https://web.dev/samesite-cookies-explained/`,linkTitle:ls`SameSite cookies explained`}],["SameSiteCookieIssue::ExcludeSameSiteUnspecifiedTreatedAsLax::SetCookie",{title:ls`A cookie was blocked, because the cookie's 'SameSite' attribute was defaulted to 'SameSite=Lax'`,message:()=>textMessageWithResolutions(ls`A cookie was defaulted to 'SameSite=Lax' because the cookie's SameSite attribute was not set or invalid. The cookie was not set because the default behavior for 'SameSite=Lax' prevents this cookie from being set in a cross-site response. This issue can only be resolved if you can change the cross-site page from which this cookie originated.`,[ls`If the cookie is intended for third parties, mark the cookie as 'SameSite=None; Secure'.`,ls`If the cookie is not intended for third parties, consider explicitly marking the cookie as 'SameSite=Strict' or 'SameSite=Lax' to make your intent clear and provide a consistent experience across browsers.`]),issueKind:IssueKind.BreakingChange,link:ls`https://web.dev/samesite-cookies-explained/`,linkTitle:ls`SameSite cookies explained`}],["SameSiteCookieIssue::ExcludeSameSiteNoneInsecure::SetCookie",{title:ls`A cookie was blocked, because the cookie specified 'SameSite=None' without 'Secure'`,message:()=>textMessageWithResolutions(ls`A cookie was received with the 'SameSite=None' attribute, marking it as available for third-party use, but did not have the 'Secure' attribute. Cookies with 'SameSite=None' are not set unless they also have the 'Secure' attribute.`,[ls`If the cookie is intended for third parties, mark the cookie as 'Secure'.`,ls`If the cookie is not intended for third parties, consider explicitly marking the cookie as 'SameSite=Strict' or 'SameSite=Lax' to make your intent clear and provide a consistent experience across browsers.`]),issueKind:IssueKind.BreakingChange,link:ls`https://web.dev/samesite-cookies-explained/`,linkTitle:ls`SameSite cookies explained`}],["SameSiteCookieIssue::WarnSameSiteNoneInsecure::SetCookie",{title:ls`A cookie will be blocked in the future, because the cookie specified 'SameSite=None' without 'Secure'`,message:()=>textMessageWithResolutions(ls`A cookie was received with the 'SameSite=None' attribute, marking it as available for third-party use, but did not have the 'Secure' attribute. Cookies with 'SameSite=None' will not be set unless they also have the 'Secure' attribute.`,[ls`If the cookie is intended for third parties, mark the cookie as 'Secure'.`,ls`If the cookie is not intended for third parties, consider explicitly marking the cookie as 'SameSite=Strict' or 'SameSite=Lax' to make your intent clear and provide a consistent experience across browsers.`]),issueKind:IssueKind.BreakingChange,link:ls`https://web.dev/samesite-cookies-explained/`,linkTitle:ls`SameSite cookies explained`}],["SameSiteCookieIssue::WarnSameSiteUnspecifiedCrossSiteContext::ReadCookie",{title:ls`A cookie will not be sent in the future, because the cookie was set without the 'SameSite' attribute`,message:()=>textMessageWithResolutions(ls`A cookie without a valid SameSite attribute was sent in a cross-site request. In the future, a cookie will only be sent in a cross-site request if the cookie has both the 'SameSite=None and 'Secure' attributes.`,[ls`If the cookie is intended for third parties, mark the cookie as 'SameSite=None; Secure'.`,ls`If the cookie is not intended for third parties, consider explicitly marking the cookie as 'SameSite=Strict' or 'SameSite=Lax' to make your intent clear and provide a consistent experience across browsers.`]),issueKind:IssueKind.BreakingChange,link:ls`https://web.dev/samesite-cookies-explained/`,linkTitle:ls`SameSite cookies explained`}]]);