import*as Common from"../common/common.js";export const DiffWrapper={charDiff:function(t,n,e){const o=new diff_match_patch,r=o.diff_main(t,n);return e&&o.diff_cleanupSemantic(r),r},lineDiff:function(t,n){const e=new Common.CharacterIdMap.CharacterIdMap,o=t.map(t=>e.toChar(t)).join(""),r=n.map(t=>e.toChar(t)).join(""),a=DiffWrapper.charDiff(o,r),i=[];for(let t=0;t<a.length;t++){const n=[];for(let o=0;o<a[t][1].length;o++)n.push(e.fromChar(a[t][1][o]));i.push({0:a[t][0],1:n})}return i},convertToEditDiff:function(t){const n=[];let e=0,o=0;for(let a=0;a<t.length;++a){const i=t[a];i[0]===Operation.Equal?(r(),n.push([Operation.Equal,i[1].length])):i[0]===Operation.Delete?o+=i[1].length:e+=i[1].length}return r(),n;function r(){if(e&&o){const t=Math.min(e,o);n.push([Operation.Edit,t]),e-=t,o-=t}if(e||o){const t=e-o,r=t<0?Operation.Delete:Operation.Insert;n.push([r,Math.abs(t)]),e=0,o=0}}}};export const Operation={Equal:0,Insert:1,Delete:-1,Edit:2};export let DiffArray;