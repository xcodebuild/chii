import*as Platform from"../platform/platform.js";import*as TextUtils from"../text_utils/text_utils.js";export class AcornTokenizer{constructor(t){this._content=t,this._comments=[],this._tokenizer=acorn.tokenizer(this._content,{onComment:this._comments});const e=Platform.StringUtilities.findLineEndingIndexes(this._content);this._textCursor=new TextUtils.TextCursor.TextCursor(e),this._tokenLineStart=0,this._tokenLineEnd=0,this._nextTokenInternal()}static punctuator(t,e){return t.type!==acorn.tokTypes.num&&t.type!==acorn.tokTypes.regexp&&t.type!==acorn.tokTypes.string&&t.type!==acorn.tokTypes.name&&!t.type.keyword&&(!e||1===t.type.label.length&&-1!==e.indexOf(t.type.label))}static keyword(t,e){return!(!t.type.keyword||t.type===acorn.tokTypes._true||t.type===acorn.tokTypes._false||t.type===acorn.tokTypes._null||e&&t.type.keyword!==e)}static identifier(t,e){return t.type===acorn.tokTypes.name&&(!e||t.value===e)}static lineComment(t){return"Line"===t.type}static blockComment(t){return"Block"===t.type}_nextTokenInternal(){if(this._comments.length)return this._comments.shift();const t=this._bufferedToken;return this._bufferedToken=this._tokenizer.getToken(),t}nextToken(){const t=this._nextTokenInternal();return t.type===acorn.tokTypes.eof?null:(this._textCursor.advance(t.start),this._tokenLineStart=this._textCursor.lineNumber(),this._tokenColumnStart=this._textCursor.columnNumber(),this._textCursor.advance(t.end),this._tokenLineEnd=this._textCursor.lineNumber(),t)}peekToken(){return this._comments.length?this._comments[0]:this._bufferedToken.type!==acorn.tokTypes.eof?this._bufferedToken:null}tokenLineStart(){return this._tokenLineStart}tokenLineEnd(){return this._tokenLineEnd}tokenColumnStart(){return this._tokenColumnStart}}